/*!
* blenddit.com - v0.0.1 - Auto-compiled on 2015-10-28 - Copyright 2015 
* @author kurtlocker
*/function tmpl(a,b){var c=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):tmpl(document.getElementById(a).innerHTML);return b?c(b):c}function getPressEvent(){return window.pressType}function init(){pjx(),blenddit()}function pjx(){$(document).pjax("a[data-pjax]","#pjax-container"),$(document).on("pjax:send",function(){}),$(document).on("pjax:end",function(){$("#listsjs").length>0?listsjs():$("#blenddit").length>0?blenddit():($(".teams").hide(),$(".navbar-fixed-top").show(),$(".navbar-brand > .text-warning").text("kurtlocker.org"),$(".social").show(),$("html, body").removeClass("noverflow"))})}function blenddit(){$("#blenddit").length>0&&($(".teams").show(),$(".social").hide(),$(".navbar-fixed-bottom").removeClass("hide"),$(".navbar-fixed-top").hasClass("hide")?void 0:$(".navbar-fixed-top").addClass("hide"),$('[data-toggle="tooltip"]').tooltip(),$("#reddit-results-collapse, #reddit-greeting-collapse, #reddit-modal-collapse").collapse({toggle:!1}),window.autoRefreshState=!0,bindAutoRefreshActive(),visibilityChange(),redditNames=redditNamesFn(),redditNames.initialize(),startBlending(),contentResizeEvent(),redditSearch("#reddit-greeting-collapse",!0),redditSearch("#reddit-results-collapse"),redditSearch("#search-control-panel",!1))}function startBlending(){var a=new Fn;if(a.setUserSession("ruser",redditUser),a.setUserSession("tuser",twitterUser),subredditURI&&threadIdURI)getThreadById(threadIdURI,function(a){"undefined"!=typeof a.data.children&&addToConfigObj(buildRedditConfigObjByThreads(a.data.children))},void 0,configObjAction);else if(subredditURI)threadsOfSubreddit(subredditURI);else if(threadIdsURI){var b=threadIdsURI.toString().split("-"),c=[];b.forEach(function(a,d){getThreadById(a,function(a){c=c.concat(a.data.children),b.length==c.length&&0!==c.length?addToConfigObj(buildRedditConfigObjByThreads(c)):void 0},function(a,d,e,f){(new Fn).remove(b,b.indexOf(f)),b.length==c.length&&0!==c.length?addToConfigObj(buildRedditConfigObjByThreads(c)):void 0},function(){b.length==c.length&&configObjAction()},!1,void 0,a)})}else configObjAction()}function checkAccessToken(a){var b=new Fn,c=b.getUserSession(a),d=c?new Date>new Date(c.ex):void 0,e=c&&c.hasRefresh===!1?c.hasRefresh:!0,f=$.Deferred();return"ruser"==a&&c&&d&&e?$.ajax("/refresh-access-token").then(function(a,c,d){return 200==d.status&&a.access_token?(b.setUserSessionAttributes("ruser",{at:a.access_token,ex:function(){var a=new Date,b=new Date(a);return b.setMinutes(a.getMinutes()+55),b}()}),f.resolve(d,a,"").promise()):(f.reject(d,a,a.statusCode).promise(),b.setUserSessionAttributes("ruser",{hasRefresh:a.hasRefresh})),f}):c&&!d?f.resolve({},{},"pass").promise():f.reject({},{},"fail").promise()}function redditNamesFn(){return new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{rateLimitWait:0,url:"https://oauth.reddit.com/api/search_reddit_names",transport:function(a,b,c){$.when(checkAccessToken("ruser")).then(function(){var d=new Fn,e=d.getRedditAuthHeader();e&&(a.headers=e,$.ajax(a).done(b).fail(c).always(d.setRedditResponseHeader))},function(a,b,c){})},prepare:function(a,b){return b.type="POST",b.hasContent=!0,b.data=$.param({query:a}),b},filter:function(a){var b=[];return a.names&&a.names.forEach(function(a){var c={};c.value=a,b.push(c)}),b}}})}function visibilityChange(){function a(a){var d="visible",e="hidden",f={focus:d,focusin:d,pageshow:d,blur:e,focusout:e,pagehide:e};a=a||window.event,b(a.type in f?"hidden"==f[a.type]?!1:!0:this[c]?!1:!0)}function b(a){window.autoRefreshState=a,autoRefresh(a),contentResizeEvent()}var c="hidden";c in document?document.addEventListener("visibilitychange",a):(c="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(c="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(c="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a,void 0!==document[c]&&a({type:document[c]?"blur":"focus"})}function autoRefresh(a,b){a?(new Fn).getFromStorage("config").forEach(function(a,b){var c=$(".frame-content[data-column="+b+"]").length>0;c&&"undefined"==typeof window["r"+b]&&toggleRefresh(b,!0)}):(new Fn).getFromStorage("config").forEach(function(a,c){var d=$(".frame-content[data-column="+c+"]").length>0;"undefined"!=typeof b&&c==b&&d?"undefined"==typeof window["r"+c]?toggleRefresh(c,!0):void 0:d?toggleRefresh(c,!1):void 0})}function redditSearch(a,b){$(a+" .reddit-search-input").hasClass("tt-input")||typeAheadReddit(a+" .reddit-search-input"),b&&bindRedditSearch.call($(a+" .reddit-search-submit"))}function submissionsSearchAPI(a){a.url=window.location.protocol+"//www.reddit.com/search.json?q="+encodeURIComponent(a.query)+"&restrict_sr=off&sort="+a.sorted_by+"&t="+a.links_from,genericGet(a.url,function(a,b,c,d){a.data.children.length>0?(threadResults(a,d,!1,"submissions"),bindLoadMore(a.data.after,"submissions",d,!0),copyToAllRedditSearches(d.query,d)):"object"==typeof d.errorLoc&&null!==d.errorLoc?(showFeature("#greeting"),copyToAllRedditSearches(d.query,d),0===$("#watch-threads .list-group.contain").children().length?watchList():void 0,$("#headingOne").launchPopOver(3e3,popOverOptions("bottom","",'There were no results found for "'+d.query+'"'))):$(d.errorLoc).launchPopOver(3e3,popOverOptions("bottom","",'There were no results found for "'+d.query+'"')),d.callback&&d.callback()},void 0,void 0,!1,a.errorLoc,a)}function subredditsSearchAPI(a){a.url=window.location.protocol+"//www.reddit.com/subreddits/search.json?q="+encodeURIComponent(a.query),genericGet(a.url,function(a,b,c,d){a.data.children.length>0?(subredditsMatching(a,d.query,!1),bindLoadMore(a.data.after,"subreddit",d,!0),copyToAllRedditSearches(d.query,d)):"object"==typeof d.errorLoc&&null!==d.errorLoc?(showFeature("#greeting"),copyToAllRedditSearches(d.query,d),0===$("#watch-threads .list-group.contain").children().length?watchList():void 0,$("#headingOne").launchPopOver(3e3,popOverOptions("bottom","",'There were no results found for "'+d.query+'"'))):$(d.errorLoc).launchPopOver(3e3,popOverOptions("bottom","",'There were no results found for "'+d.query+'"'))},void 0,void 0,!1,a.errorLoc,a)}function threadsOfSubreddit(a,b){var c=window.location.protocol+"//www.reddit.com/r/"+a+".json";genericGet(c,function(b,c,d,e){threadResults(b,e,!1),bindLoadMore(b.data.after,"thread",e,!0),copyToAllRedditSearches(a,e),e.callback&&e.callback()},noResults,void 0,!1,void 0,{query:a,errorLoc:this,callback:b,url:c})}function copyToAllRedditSearches(a,b){if($("#reddit-search-results .reddit-search-input.tt-input, form.reddit-search .reddit-search-input.tt-input, #control-panel-panels .reddit-search-input.tt-input").val(a),b&&b.errorLoc!==window&&null!==b.errorLoc){var c=b.errorLoc.parents("form"),d=c.find("input[type=radio]:checked").val(),e=c.find("select.sorted-by").val(),f=c.find("select.links-from").val();$("form.reddit-search").each(function(a,b){bindRedditSearchRadio.call($(b).find("input[type=radio][value="+d+"]").prop("checked",!0)),$(b).find("select.sorted-by option[value="+e+"]").prop("selected",!0),$(b).find("select.links-from option[value="+f+"]").prop("selected",!0)})}$("#reddit-results-collapse").collapse("hide")}function noResults(a,b,c,d){return 403==a.status?($("#search-results-container .reddit-search-input.tt-input").val(d.query),window.scrollTo(0,0),void $("#reddit-search-results").launchPopOver(5e3,popOverOptions("bottom","","This subreddit is private and you do not have access to view it."))):void subredditsSearchAPI(d)}function subredditsMatching(a,b,c){showFeature("#search-results-container"),window.scrollTo(0,0),$("#subreddit-result-title").text('Subreddits matching "'+b+'"..'),buildRedditMedia(a,"t5",c)}function threadResults(a,b,c,d){showFeature("#search-results-container"),window.scrollTo(0,0),"submissions"==d?$("#subreddit-result-title").text('Submissions matching "'+b.query+'"..'):$("#subreddit-result-title").text("/r/"+b.query),buildRedditMedia(a,"t3",c)}function typeAheadReddit(a,b){$(a).typeahead(null,{name:"reddit-names",displayKey:"value",source:redditNames.ttAdapter(),limit:20}).on("typeahead:selected typeahead:autocompleted",function(){b&&b(this)})}function configObjAction(){(new Fn).getFromStorage("config").length>0?($(".carousel-inner").children().remove(),buildConfigToUI()):(showFeature("#greeting"),watchList())}function popOverOptions(a,b,c){return{placement:a,title:b,content:c,trigger:"manual"}}function watchList(){var a,b=(new Fn).getFromStorage("watch");a=Object.keys(b).length?b:{subs:["nfl","nba","mlb","nhl","mls","hockey","soccer","collegebasketball"],match:["Game Thread","Match Thread","Live Thread"]},buildWatchList(a),fetchWatchThreads(a.match)}function fetchWatchThreads(a){$("#watch-threads .list-group.contain").children().remove(),$("#watch-list-no-results").removeClass("hide"),$("#watch-subreddits input").each(function(b,c){getPosts("/r/"+c.value,"","",{target:a,callback:function(b){b.data.children.forEach(function(b){a.some(function(a){var c=new RegExp(a.toLowerCase());return c.test(b.data.title.toLowerCase())})&&($("#watch-list-no-results").addClass("hide"),$("#watch-threads .list-group.contain").append(buildWatchInputOrThreadHtmlString(b.data))),fadeIn($("#watch-threads .list-group-item"),100)})}})})}function saveWatchList(){var a={};a.subs=function(){var a=[];return $("#watch-subreddits .list-group.contain input").each(function(b,c){""!==c.value&&null!==c.value?a.push(c.value):""}),a}(),a.match=function(){var a=[];return $("#watch-matching .list-group.contain input").each(function(b,c){""!==c.value&&null!==c.value?a.push(c.value):""}),a}(),(new Fn).setInStorage("watch",a)}function contentResizeEvent(){function a(){$("#greeting").hasClass("hide")?$(".carousel-inner").css("height",window.innerHeight-53):$(".carousel-inner").removeAttr("style")}window.height=window.innerHeight,window.width=window.innerWidth,a(),frame_content_height(),autoRefreshOnlyActiveColumn(),$(window).unbind("resize").on("resize",function(){window.height!=window.innerHeight&&(a(),frame_content_height(),window.height=window.innerHeight),window.width!=window.innerWidth&&(a(),frame_content_height(),autoRefreshOnlyActiveColumn(),window.width=window.innerWidth)})}function autoRefreshOnlyActiveColumn(){var a=$(".item.active"),b=a.data("column");$("#content-container").hasClass("hide")?autoRefresh(!1):window.innerWidth<=640?"undefined"!=typeof b&&autoRefresh(!1,b):autoRefresh(!0)}function column_options_height(a,b){var c=$(".column-options[data-column="+a+"]");c.removeAttr("style").css("max-height",c.height()),frame_content_height(a,b)}function frame_content_height(a,b){var c="undefined"!=typeof a?$(".frame-content[data-column="+a+"]"):$(".frame-content"),d=$(".carousel-inner").hasWidthOverflowed()?10:0;if("undefined"==typeof a)c.each(function(a,c){var e=$(".column-options[data-column="+a+"]").hasClass("hide")?0:$(".column-options[data-column="+a+"]").height(),f="undefined"!=typeof b?b:e;$(c).removeAttr("style").css("height",window.innerHeight-(107+f+d))});else{var e=$(".column-options[data-column="+a+"]").hasClass("hide")?0:$(".column-options[data-column="+a+"]").height(),f="undefined"!=typeof b?b:e;c.removeAttr("style").css("height",window.innerHeight-(107+f+d))}}function launchControls(){$("#controls").modal("toggle"),updateControlsView()}function updateControlsView(){var a=new Fn,b=a.getFromStorage("config"),c=a.getUserSession("ruser"),d=a.getUserSession("tuser"),e=c&&c.ru?1:0,f=d&&d.tu?1:0;e?$(".reddit-account").replaceWith(tmpl("tmpl_ar",{title:c.ru,type:"'ruser'"})):$(".reddit-account").replaceWith(tmpl("tmpl_as",{type:"'reddit'"})),f?$(".twitter-account").replaceWith(tmpl("tmpl_at",{avatar:d.ua,user:d.tu,type:"'tuser'"})):$(".twitter-account").replaceWith(tmpl("tmpl_au",{type:"'twitter'"})),$(".panel-red .huge").text(getColumnCount(b,"reddit")),$(".panel-primary .huge").text(getColumnCount(b,"twitter")),$(".panel-yellow .huge").text(e+f)}function getColumnCount(a,b){var c=0;return a.forEach(function(a){a.type==b&&c++}),c}function addColumnToConfig(){var a=!1;return(new Fn).any(".thread-controls",function(a){return!(null===$(a).val())})&&(1==$(".sub-group-controls").length?$("#column-name").val($(".sub-group-controls .thread-controls option:selected").text().trim().substr(0,22)+" ..."):$("#column-name").val("My Column"),a=updateConfigObjFromDOM(".sub-group-controls",".subreddit-controls",".thread-controls","#reddit-column .column-settings"),a&&$("#reddit-column").collapse("hide")),a}function showColumnOption(a,b){hideAllColumnOptions(b),$(a).removeClass("hide"),$(a[0].previousElementSibling).removeClass("hide")}function showAllColumnOptions(a){$([".settings-switch[data-column="+a+"]",".manage-threads[data-column="+a+"]",".write-comment-switch[data-column="+a+"]",".refreshSwitch[data-column="+a+"]",".trash[data-column="+a+"]"].join(",")).removeClass("hide"),$([".write-comment[data-column="+a+"]",".edit-form[data-column="+a+"]",".settings-tab[data-column="+a+"]"].join(",")).addClass("hide")}function hideAllColumnOptions(a){$([".write-comment[data-column="+a+"]",".settings-switch[data-column="+a+"]",".edit-form[data-column="+a+"]",".manage-threads[data-column="+a+"]",".settings-tab[data-column="+a+"]",".write-comment-switch[data-column="+a+"]",".refreshSwitch[data-column="+a+"]",".trash[data-column="+a+"]"].join(",")).addClass("hide")}function showFeature(a){if(hideAllFeatures(),fadeIn($(a).removeClass("hide"),100),"#greeting"==a&&$(".home-button").addClass("active-feature"),"#content-container"==a){var b=(new Fn).getFromStorage("config");$("html, body").addClass("noverflow"),autoRefreshOnlyActiveColumn(),$(".columns-button").addClass("active-feature"),b.length>1?$(".carousel-control").removeClass("hide"):$(".carousel-control").addClass("hide")}else $("html, body").removeClass("noverflow")}function hideAllFeatures(){autoRefresh(!1),$("#main-loader-container, #content-container, #greeting, #search-results-container").removeClass("faded").addClass("hide"),$(".home-button, .columns-button, .open-controls").removeClass("active-feature"),$(".carousel-control").addClass("hide")}function setPostThreads(a,b){var c=$(a+" .post-thread"),d=$(b+" .thread-edit");c.children().remove(),d.each(function(a,b){$(b).val()&&c.append($(b).find("option:selected").clone())})}function setSettingsFromConfig(a,b){$("#column-name-column-"+a).val(b.settings.name),$("#refresh-column-"+a).val(b.settings.refreshRate),$("#limit-column-"+a).val(b.settings.limitPosts),$("#sortBy-column-"+a).val(b.settings.sortBy)}function deleteRefresh(a){clearInterval(window["r"+a]),delete window["r"+a]}function toggleRefresh(a,b){var c="undefined"!=typeof b?$(".refreshSwitch[data-column="+a+"] i").hasClass("fa-toggle-on")&&b:$(".refreshSwitch[data-column="+a+"] i").hasClass("fa-toggle-on"),d=(new Fn).getFromStorage("config");deleteRefresh(a),c&&window.autoRefreshState?window["r"+a]=setInterval(function(){d[a]?getCommentsForColumn(d[a],a):clearInterval(window["r"+a])},1e3*parseInt(d[a].settings.refreshRate)):clearInterval(window["r"+a])}function makeItemActive(a){$(".item").removeClass("active"),$(".item[data-column="+a+"]").addClass("active")}function cacheColumn(a,b,c){a[b].cachedComments=c,(new Fn).setInStorage("config",a)}function getCommentsForColumn(a,b,c){if(showLoader(b),c&&a.cachedComments){a.cachedComments.forEach(function(a){a[2]=b});var d=getMergedData(a.cachedComments);return d&&0===$(".frame-content[data-column="+b+"]").children().length&&d[1].data.children.length>0&&markFirstComment(d[1].data.children[0].data.name,b),d&&displayComments(d,b),void hideLoader(b)}for(var e=[],f=0,g=a.threads.length;g>f;f++){var h=a.threads[f].thread,i=a.settings.sortBy,j=a.settings.limitPosts;getPosts(h,i,j,{target:{columnNum:b,threadNum:f},errorMsgLoc:".frame[data-column="+b+"]",callback:function(a,c){var d=new Fn,f=d.getFromStorage("config");if(e=e.concat([a.concat(c.columnNum).concat(c.threadNum)]),"undefined"!=typeof f[c.columnNum]&&f[c.columnNum].threads.length==e.length){cacheColumn(f,b,e);var g=getMergedData(e);0===$(".frame-content[data-column="+b+"]").children().length&&g[1].data.children.length>0&&markFirstComment(g[1].data.children[0].data.name,c.columnNum),displayComments(g,c.columnNum),hideLoader(c.columnNum)}}})}}function appendColNumAndThreadNum(a,b,c){return a.forEach(function(a){var d="more"!=a.kind&&a.data.replies.hasOwnProperty("data")?a.data.replies.data.children:[];a.data.name+="-"+b+"-"+c,a.data.parent_id+="-"+b+"-"+c,appendColNumAndThreadNum(d,b,c)}),a}function markFirstComment(a,b){"undefined"!=typeof a&&(window["firstComment"+b]=a)}function updateConfigObjFromDOM(a,b,c,d,e){var f={},g={},h=[],i=$(a),j=$(d).find(".form-control"),k=!1,l="undefined"!=typeof e&&"reddit"==$(".frame-position[data-column="+e+"]").data("type")||!$("#reddit").hasClass("hide")?"reddit":"twitter",m=new Fn,n=m.getFromStorage("config");return i.each(function(a,d){var e=$(d).find(c).val(),f=$(d).find(b+".tt-input").val();if(e&&f){var g={},i=$(d).find(c+" option:selected");g.subreddit=$(d).find(b+".tt-input").val(),g.thread=$(d).find(c).val(),g.threadid=i.data("threadid"),g.threadtitle=i.data("threadtitle"),g.subid=i.data("subid"),h.push(g)}}),i.length>0&&m.any(i.find(c),function(a){return null!==$(a).val()})&&m.any(i.find(b+".tt-input"),function(a){return""!==$(a).val()})&&(f.threads=h,g.name=j[0].value,g.refreshRate=j[1].value,g.limitPosts=j[2].value,g.sortBy=j[3].value,f.settings=g,f.type=l,"undefined"!=typeof e?n[e]=f:function(){n=n.concat(f),k=!0}(),m.setInStorage("config",n)),k}function addToConfigObj(a){var b=new Fn;b.setInStorage("config",b.getFromStorage("config").concat(a))}function setThreads(a,b){var c="undefined"!=typeof b[2]?$($(b[0]+"[data-column="+b[2]+"]")[b[1]]):$($(b[0])[b[1]]),d=(new Fn).getFromStorage("config");if(c.children().remove(),a.data.children.forEach(function(a){c.append(tmpl("tmpl_v",{post:a}))}),d.length>0&&"undefined"!=typeof b[2]){var e=d[b[2]].threads[b[1]];0===c.find("option[data-threadid="+e.threadid+"]").length&&e.subid==c.find("option:selected").data("subid")&&c.append(tmpl("tmpl_w",{threadObj:e})),c.find("option[data-threadid="+e.threadid+"]").prop("selected",!0)}}function showLoader(a){$(".frame-overlay[data-column="+a+"]").addClass("half-fade"),$(".loading[data-column="+a+"]").removeClass("hide").addClass("faded")}function hideLoader(a){$(".frame-overlay[data-column="+a+"]").removeClass("half-fade"),$(".loading[data-column="+a+"]").removeClass("faded"),setTimeout(function(){$(".loading[data-column="+a+"]").addClass("hide")},500)}function fadeIn(a,b,c){setTimeout(function(){$(a).addClass(c?c:"faded")},b)}function getIcon(a){return"icon-"+a}function updateVoteState(a,b){var c=$(".vote.up[data-id^="+b.id+"]"),d=$(".vote.down[data-id^="+b.id+"]");$(".score[data-id^="+b.id+"]").data("vote-state",b.dir),1==b.dir?(c.addClass("active"),d.removeClass("active")):-1==b.dir?(d.addClass("active"),c.removeClass("active")):(c.removeClass("active"),d.removeClass("active"))}function replyLevelCommentFail(a){$("#reply-textarea, #reply-save").removeAttr("disabled"),$($("#reply-textarea")[0].form).launchPopOver(3e3,popOverOptions("top","","There was a problem posting your reply. Try again!"))}function topLevelCommentFail(a){var b=$(a.postPane).find("form");b.find(".save-reply").removeAttr("disabled"),b.find(".textarea-reply").removeAttr("disabled"),frame_content_height(a.columnNum),b.find(".textarea-reply").launchPopOver(3e3,popOverOptions("top","","There was a problem posting your comment. Try again!"))}function postTopLevelComment(a,b){var c=$(b.postPane).find("form"),d=c.find(".textarea-reply");d.val("").removeAttr("disabled"),c.find(".save-reply").removeAttr("disabled"),frame_content_height(b.columnNum),bindColumnBars.call($(".column-bars[data-column="+b.columnNum+"] > a"),b.columnNum),bindGetCommentsForColumn.call($(".frame[data-column="+b.columnNum+"] .frame-header"),b.columnNum)}function insertReplyIntoDOM(a,b){$("#reply-textarea, #reply-save").removeAttr("disabled"),$("#reply-modal").modal("toggle"),$(buildCommentHtmlString(appendColNumAndThreadNum(a,b.columnNum,b.threadNum),!0)).insertAfter("#"+a[0].data.parent_id+" .comment-footer:first"),externalLinks(".md a"),fadeIn($("#"+a[0].data.name),100)}function externalLinks(a){$(a).each(function(a,b){b.onclick=stopProp,$(b).attr("target","_blank"),"/u/"==$(b).attr("href").substring(0,3)||"/r/"==$(b).attr("href").substring(0,3)?$(b).attr("href",window.location.protocol+"//www.reddit.com"+$(b).attr("href")):""})}function displayComments(a,b){var c=$(".frame-content[data-column="+b+"]");if(c.children().length){var d=window["firstComment"+b];if(d!=a[1].data.children[0].data.name){var e=(new Fn).takeWhile(a[1].data.children,d,function(a,b){return!document.getElementById(a.data.name)&&a.data.name!=b});$(".frame-content[data-column="+b+"]").prepend(buildCommentHtmlString(e,!0,!0)),e.forEach(function(a){fadeIn($("#"+a.data.name),500)}),e.length>0&&$(".frame-overlay[data-column="+b+"]").launchPopOver(3e3,popOverOptions("bottom","",e.length+" new comments!")),markFirstComment(a[1].data.children[0].data.name,b)}updateCommentStats(a[1].data.children),updateCreatedUTC(b)}else c.append(buildCommentHtmlString(a[1].data.children,!0,!0)),fadeIn(c.children(),100);externalLinks(".md a")}function updateCreatedUTC(a){var b=document.getElementsByDataAttribute(".frame-content","data-column",a)[0],c=b.getElementsByClassName("time-elapsed");c.forEach(function(a){a.innerHTML=getTimeElapsed(a.getAttribute("data-created-utc"))})}function updateCommentStats(a){a.forEach(function(a){var b="more"!=a.kind&&a.data.replies.hasOwnProperty("data")?a.data.replies.data.children:[],c=b.length,d="#"+a.data.name,e=d+" .reply-container[data-id="+a.data.name+"]";"undefined"!=typeof a.data.score?$(".score[data-id="+a.data.name+"]").text(a.data.score):void 0,newCommentsOnRefresh(c,a.data.name,e),updateCommentStats(b)})}function newCommentsOnRefresh(a,b,c){var d=$("#"+b+" .media[data-parentid="+b+"]"),e=$(c+" .reply"),f=$(c+" .reply .reply-num"),g=a-d.length,h=tmpl("tmpl_ab",{newRepliesNum:g}),i=tmpl("tmpl_ac",{replyLength:a,replyText:a>1?"replies":"reply"});if(a>0&&e.length>0&&a>e.data("replylength"))e.data("replylength",a),f.text(a),g>0&&0===$(c+" .new-comment").length?$(h).insertAfter(c+" .reply"):(!e.children().length&&d.length>0&&(e.append(i),$(c+".reply .expander").html("&#8722;")),0>=g?void 0:$(c+" .new-comment .diff").text(g+" new"));else if(a>0&&0===e.length){var j=tmpl("tmpl_ad",{name:b,replyLength:a});$(c).append(j),g>0&&$(h).insertAfter(c+" .reply"),d.hasClass("faded")&&($(c+" .reply").append(i),$(c+" .reply .expander").html("&#8722;"))}}function getThreadById(a,b,c,d,e,f,g){genericGet(window.location.protocol+"//www.reddit.com/by_id/t3_"+a+".json",b,c,d,e,f,g)}function getCommentsByLink(a,b,c,d){genericGet(window.location.protocol+"//www.reddit.com/comments/"+a+".json?sort=new",b,c,d)}function getCommentsById(a,b,c,d,e){genericGet(window.location.protocol+"//www.reddit.com/comments/"+a.substr(3)+"/_/"+b+".json?sort=new",c,d,e)}function getPermalink(a,b){return window.location.protocol+"//www.reddit.com/comments/"+a.substr(3)+"/_/"+b}function getTimeElapsed(a){if(a){var b=new Date(1e3*a),c=6e4,d=60*c,e=24*d,f=new Date,g=f.getTime(),h=g-b.getTime(),i=Math.floor(h/e);h-=i*e;var j=Math.floor(h/d);h-=j*d;var k=Math.floor(h/c);h-=k*c;var l=Math.floor(h/1e3);return 0!=!i||0>=i?0==i&&0==!j?j.toLocaleString()+"h":0==i&&0==j&&0==!k?k.toLocaleString()+"m":0==i&&0==j&&0==k&&0==!l?l.toLocaleString()+"s":1e3>g-1e3*a?"1s":b.toLocaleTimeString():i.toLocaleString()+"d"}}function getMergedData(a){var b=[];return a.forEach(function(c,d){c.length>0&&(b=b.concat(appendColNumAndThreadNum(c[1].data.children,a[d][2],a[d][3])))}),b=b.filter(function(a){return"more"!=a.kind?a:void 0}).sort(byTimeCreated),a[0][1].data.children=b,a[0]}function byTimeCreated(a,b){return"more"!=a.kind&&"more"==b.kind?1:"more"==a.kind&&"more"!=b.kind?-1:a.data.created_utc<b.data.created_utc?1:a.data.created_utc>b.data.created_utc?-1:0}function errorPop(a,b){"undefined"!=typeof a&&("timeout"==b?$(a).launchPopOver(3e3,popOverOptions("bottom","Servers Busy","Reddit servers are busy.")):$(a).launchPopOver(3e3,popOverOptions("bottom","Generic Error","There was an error processing this request. Reddit servers could not be reached or are busy. Try refreshing.")))}function genericGet(a,b,c,d,e,f,g){$.ajax({url:a,type:"GET",timeout:7e3,cache:e||!1}).done(function(a,c,d){b&&b(a,c,d,g)}).fail(function(a,b,d){c&&c(a,b,d,g),errorPop(f,d)}).always(function(){d&&d()})}function genericPost(a,b,c,d,e,f,g,h){$.ajax({url:a,type:"POST",timeout:f.timeout||7e3,data:b,cache:!1,headers:h||{}}).done(function(a,b,d){c&&c(a,b,d,f)}).fail(function(a,b,c){d&&d(a,b,c,f),errorPop(g,c)}).always(function(a,b,c){e&&e(a,b,c)})}function getPosts(a,b,c,d){$.ajax({url:window.location.protocol+"//www.reddit.com"+a+"/.json?sort="+b+"&limit="+c+"&jsonp=?",dataType:"json",timeout:7e3,cache:!1}).done(function(a){d.callback(a,d.target)}).fail(function(a,b,c){errorPop(d.errorMsgLoc,c),hideLoader(d.target.columnNum)}).always(function(){d.always&&d.always(d.target)})}function buildRedditMedia(a,b,c){var d=$("#search-results-container .media-results");c===!1&&d.children().remove(),"t3"==b?a.data.children.forEach(function(a,b){d.append(tmpl("tmpl_ao",{obj:a,permalink:a.data.permalink.split("?")[0],timeElapsed:getTimeElapsed(a.data.created_utc),thumbnail:a.data.thumbnail&&"self"!=a.data.thumbnail&&"default"!=a.data.thumbnail?tmpl("tmpl_ao0",{src:window.location.protocol+a.data.thumbnail.substr(5)}):tmpl("tmpl_ap",{})})),fadeIn($("#search-results-container .media-results li:last-child"),100+50*b,"opacity-7")}):"t5"==b&&a.data.children.forEach(function(a,b){var c=getTimeElapsed(a.data.created_utc);d.append(tmpl("tmpl_aq",{obj:a,timeElapsed:c,subscribers:a.data.subscribers?parseInt(a.data.subscribers).toLocaleString()+" subscribers, a community for "+c:"A community for "+c})),fadeIn($("#search-results-container .media-results li:last-child"),100+50*b,"opacity-7")})}function buildWatchList(a){var b=a.subs,c=a.match,d="",e="";b.forEach(function(a){d+=buildWatchInputOrThreadHtmlString(a,"input")}),c.forEach(function(a){e+=buildWatchInputOrThreadHtmlString(a,"input")}),$("#watch-subreddits .list-group.contain, #watch-matching .list-group.contain").children().remove(),$("#watch-subreddits .list-group.contain").append(d),$("#watch-matching .list-group.contain").append(e)}function buildRedditConfigObjByThreads(a){var b={},c={},d=[];return a.forEach(function(a){var b={};b.subid=a.data.subreddit_id,b.subreddit=a.data.subreddit.toLowerCase(),b.thread=a.data.permalink,b.threadid=a.data.id,b.threadtitle=a.data.title,d.push(b)}),c.limitPosts="50",c.name=1==a.length?a[0].data.title.length>25?a[0].data.title.trim().substring(0,22)+" ...":a[0].data.title.trim():"My Column",c.refreshRate="60",c.sortBy="new",b.type="reddit",b.settings=c,b.threads=d,b}function buildColumn(a,b,c){$(".item[data-column="+b+"]").remove();var d=tmpl("tmpl_i",{num:b}),e=tmpl("tmpl_j",{num:b}),f=tmpl("tmpl_l",{bigButtons:tmpl("tmpl_p",{columnNum:b}),type:"reddit"==a.type?tmpl("tmpl_ired",{}):tmpl("tmpl_itwt",{}),num:b,configObj:a,icons:e,frameContent:d}),g=tmpl("tmpl_m",{frame:f}),h=tmpl("tmpl_n",{num:b,configObj:a,frameContainer:g}),i=tmpl("tmpl_o",{num:b,active:0===b?"active":"",framePosition:h});buildColumnToUI(i,b),buildColumnOptions(a,b,"column"),"reddit"==a.type&&(getCommentsForColumn(a,b,c),toggleRefresh(b)),contentResizeEvent(),fadeIn(".frame-position[data-column="+b+"]",100)}function buildCommentHtmlString(a,b,c,d){var a=a||[],e="";return a.forEach(function(a){var f="more"!=a.kind&&a.data.replies.hasOwnProperty("data")?a.data.replies.data.children:[],g=f.length,h="more"!=a.kind?tmpl("tmpl_ae",{comment:a,replyLength:g,permalink:getPermalink(a.data.link_id,a.data.id),replies:0!==g?tmpl("tmpl_af",{comment:a,replyLength:g,replyText:g>1?"replies":"reply"}):""}):"",i=$("<div/>").html(a.data.body_html).text()+h+buildCommentHtmlString(f,!0,!1,!0),j="more"!=a.kind?tmpl("tmpl_ag",{comment:a,text:i,timeElapsed:getTimeElapsed(a.data.created_utc),href:window.location.protocol+"//www.reddit.com/r/"+a.data.subreddit,authorLink:window.location.protocol+"//www.reddit.com/u/"+a.data.author,author:a.data.author,flair:a.data.author_flair_css_class?'<a class="flair btn">'+a.data.author_flair_css_class+"</a>":"&nbsp;"}):tmpl("tmpl_ah",{comment:a,text:i}),k=tmpl("tmpl_ai",{heading:j}),l="more"!=a.kind?tmpl("tmpl_aj",{icon:c?getIcon(a.data.subreddit):""}):"",m=tmpl("tmpl_ak",{comment:a,icon:getIcon(a.data.subreddit),parent:c?"parent":d?"hide":"",opacity:b?"nopacity":"",thumbnail:l,body:k});e+=m}),e}function buildWatchInputOrThreadHtmlString(a,b){return a.timeElapsed=getTimeElapsed(a.created_utc),"input"==b?tmpl("tmpl_a",{thing:a}):tmpl("tmpl_b",{thing:a})}function buildColumnToUI(a,b){var c=$(".carousel-inner");0===b?c.children().length>0?$(a).insertBefore(".item:first"):c.append(a):$(a).insertAfter($(".item[data-column="+(b-1)+"]"))}function buildReplyForm(a,b,c){var d=tmpl("tmpl_x",{buttonClass:c?"btn-default":"btn-primary"}),e=tmpl("tmpl_y",{thing_id:a}),f=tmpl("tmpl_z",{label:c?"<label>Comment</label>":"",placeholder:c?"Write a comment":"Reply to "+b+"..."}),g=tmpl("tmpl_aa",{className:c?"isTopLevel":"nopacity hide",submitting:c?'<b><span class="black">Submitting...</span></b>':"Submitting...",parentInput:e,textarea:f,buttons:d});return g}function buildConfigToUI(a){var b=(new Fn).getFromStorage("config");if(0===b.length)showFeature("#greeting"),0===$("#watch-threads .list-group.contain").children().length?watchList():void 0;else if(showFeature("#content-container"),0===$(".carousel-inner").children().length||a){a&&$(".carousel-inner").children().remove();for(var c=0,d=b.length;d>c;c++)buildColumn(b[c],c,!0)}contentResizeEvent()}function buildButtons(a){var b="";return a.forEach(function(a){b+=tmpl("tmpl_c0",{arrPos0:a[0],arrPos1:a[1],arrPos2:a[2]})}),b}function buildColumnOptions(a,b){var c=function(){for(var c=tmpl("tmpl_c",{ulClass:"edit-button-group",buttons:buildButtons([["add-thread-button","plus-circle",getPressEvent()+"=\"bindAddThreadButton.call(this, '.edit-form[data-column="+b+"]', 'edit-button-group', 'subreddit-group-edit', 'subreddit-edit', 'thread-edit', 'delete-edit', 'info-edit', "+b+')"'],["cancel-edit-button","close",getPressEvent()+'="bindCancelEdit.call(this, '+b+')"'],["save-edit-button","save",getPressEvent()+'="bindSaveEdit.call(this, '+b+')"']])}),d=0,e=a.threads.length;e>d;d++){var f=tmpl("tmpl_d",{columnNum:b}),g=tmpl("tmpl_e",{columnNum:b}),h=tmpl("tmpl_f",{subreddit:g,threads:f});c+=h}return c}(),d=function(){var a=tmpl("tmpl_c",{ulClass:"edit-button-group",buttons:buildButtons([["cancel-edit-button","close",getPressEvent()+'="bindCancelEdit.call(this, '+b+')"'],["save-edit-button","save",getPressEvent()+'="bindSaveEdit.call(this, '+b+')"']])}),c=$("<div>").append($(".column-settings").children().clone().each(function(){var a=$(this).find("label"),c=$(this).find("*[id]");a.each(function(a,c){$(c).attr("for",$(c).attr("for")+"-column-"+b)}),c.each(function(a,c){$(c).attr("id",$(c).attr("id")+"-column-"+b)})})).html();return tmpl("tmpl_g",{settings:a+c,columnNum:b})}(),e=tmpl("tmpl_am",{})+buildReplyForm("","",!0);$(".edit-form[data-column="+b+"]").append(c),$(".settings-tab[data-column="+b+"]").append(d),$(".write-comment[data-column="+b+"]").append(e),inputLoad(b),setSettingsFromConfig(b,a)}function bindNewComment(){event.preventDefault(),event.stopPropagation();var a=$(this).parents(".media").attr("id"),b=$(".refresh-comment[data-id="+a+"]");bindRefreshComment.call(b);
}function bindLoadMore(a,b,c,d){event.preventDefault();var e=$(".media-more li");e.data("after",a),e.data("type",b),e.data("query",c.query),d?e.data("count",25):e.data("count",e.data("count")+25),bindMediaMore(a,b,c)}function bindMediaMore(a,b,c){$(".media-more li").unbind(getPressEvent().slice(2)).on(getPressEvent().slice(2),function(){event.preventDefault();var a=$(this).data("type"),b="thread"==a?c.url+"?count="+$(this).data("count")+"&after="+$(this).data("after"):c.url+"&count="+$(this).data("count")+"&after="+$(this).data("after"),d="thread"==a||"submissions"==a?function(b,d,e,f){f.previousAfter?(threadResults(b,c,!0,a),$("#search-results-container .media[data-id="+f.previousAfter.substr(3)+"]")[0].scrollIntoView(),bindLoadMore(b.data.after,a,c)):$(".media-more li").unbind("click")}:function(b,d,e,f){f.previousAfter?(subredditsMatching(b,c.query,!0),$("#search-results-container .media[data-id="+f.previousAfter.substr(3)+"]")[0].scrollIntoView(),bindLoadMore(b.data.after,a,c)):$(".media-more li").unbind("click")};genericGet(b,d,void 0,void 0,!1,this,{query:c.query,previousAfter:$(this).data("after")})})}function bindSubList(){event.preventDefault(),copyToAllRedditSearches($(this).data("subreddit")),threadsOfSubreddit($(this).data("subreddit"))}function bindThreadResults(){event.preventDefault();var a={},b={};b.subreddit_id=$(this).data("subid"),b.subreddit=$(this).data("subreddit"),b.permalink=$(this).data("thread"),b.id=$(this).data("id"),b.title=$(this).find("h4").text(),a.data=b,addToConfigObj(buildRedditConfigObjByThreads([a])),configObjAction(),makeItemActive((new Fn).getFromStorage("config").length-1)}function bindWatchThreads(){event.preventDefault(),$(this).hasClass("white")?$(this).removeClass("white"):$(this).addClass("white")}function bindSignOut(a){event.preventDefault(),localStorage&&localStorage.removeItem(a),updateControlsView()}function bindLogIn(a){window.location="/auth/"+a}function bindSubmitSave(a){event.preventDefault(),bindSaveEdit.call($(this.form).find(".save-edit-button"),a)}function inputLoad(a){event.preventDefault();var b=$(".edit-form[data-column="+a+"] .subreddit-edit"),c=(new Fn).getFromStorage("config");b.each(function(b,d){this.value=c[a].threads[b].subreddit,typeAheadReddit(d,function(b){var c=".edit-form[data-column="+a+"] .subreddit-edit",d=$(c).parent().parent().parent().index($(b).parent().parent().parent());getPosts("/r/"+b.value,"","",{target:[".edit-form[data-column="+a+"] .thread-edit",d],errorMsgLoc:b,callback:setThreads})})})}function bindFetchThreadValue(a){if(event.preventDefault(),this.value){var b=".edit-form[data-column="+a+"] .subreddit-edit",c=$(b).parent().parent().parent().index($(this).parent().parent().parent());getPosts("/r/"+this.value,"","",{target:[".edit-form[data-column="+a+"] .thread-edit",c],errorMsgLoc:this,callback:setThreads})}}function bindSaveEdit(a){event.preventDefault(),updateConfigObjFromDOM(".column-options[data-column="+a+"] .subreddit-group-edit",".subreddit-edit",".thread-edit",".column-options[data-column="+a+"] .edit-column-settings",a),buildColumn((new Fn).getFromStorage("config")[a],a),makeItemActive(a)}function bindCancelEdit(a){event.preventDefault(),showAllColumnOptions(a)}function bindAddThreadButton(a,b,c,d,e,f,g,h){event.preventDefault();var i=tmpl("tmpl_s",{infoClass:g,threadClass:e}),j=tmpl("tmpl_t",{input:"'"+a+" ."+d+".tt-input:first'",deleteClass:f,subClass:d,groupClass:"'"+c+"'",threadClass:"'"+e+"'",columnNum:"undefined"!=typeof h?h:!1}),k=tmpl("tmpl_u",{groupClass:c,subreddit:j,threads:i});$(k).insertAfter(a+" ."+b),"undefined"!=typeof h?frame_content_height(h):void 0,typeAheadReddit(a+" ."+d+":first",function(b){var d=$(a+" ."+c).index($(b).parent().parent().parent());getPosts("/r/"+b.value,"","",{target:[a+" ."+e,d],errorMsgLoc:b,callback:setThreads})}),fadeIn("."+c,100)}function bindPopulateThreadSelect(a,b,c){event.preventDefault();var d=$("."+b).index($(this).parent().parent().parent());getPosts("/r/"+this.value,"","",{target:["."+c,d],errorMsgLoc:this,callback:setThreads})}function bindInfoThread(a){event.preventDefault();var b=$(this).parents(".form-group").find("select option:selected").data("threadid");b&&getThreadById(b,function(a){a.data.children[0].data.selftext_html?($("#info-title, #info-content").children().remove(),$("#info-title").html(tmpl("tmpl_an",{url:a.data.children[0].data.url,title:a.data.children[0].data.title})),$("#info-content").append($("<div/>").html(a.data.children[0].data.selftext_html).text()),$("#author-button").text("/u/"+a.data.children[0].data.author).attr(getPressEvent(),"window.open('"+window.location.protocol+"//www.reddit.com/u/"+a.data.children[0].data.author+"','_blank');"),$("#time-button").text(getTimeElapsed(a.data.children[0].data.created_utc)),externalLinks("#info-content .md a"),$("#info-modal").modal()):window.open(a.data.children[0].data.url,"_blank")},void 0,void 0,!0,this)}function bindDeleteThread(a){event.preventDefault(),$(this).parent().parent().parent().remove(),"undefined"!=typeof a&&frame_content_height(a)}function bindVoteCast(){event.preventDefault();var a=this;$.when(checkAccessToken("ruser")).then(function(){var a=new Fn,b=$(this).data("id").split("-")[0],c=$(".score[data-id="+$(this).data("id")+"]").data("vote-state"),d=$(this).hasClass("up")?1:-1,e=d==c?0:1==d?1:-1,f={id:b,dir:e},g=a.getRedditAuthHeader();done=function(a,b,c,d){a.statusCode?console.log(a.statusCode):a.json&&a.json.errors.length>0?alert(a.json.errors[0][1]):updateVoteState(a,d)},fail=function(a,b,c,d){alert(b+": Couldn't cast vote to "+d.id)},g&&genericPost("https://oauth.reddit.com/api/vote",f,done,fail,a.setRedditResponseHeader,f,void 0,g)}.bind(a),function(){$("#login-reddit-modal").modal()}),(new Fn).getBlurred()}function bindSaveReply(){event.preventDefault();var a=new Fn,b=$(this).parents(".write-comment"),c=this.form?this.form.thing_id.value:$(this).parents(".modal-content").find("form")[0].thing_id.value,d=c.split("-")[0]||"t3_"+b.find(".post-thread option:selected").data("threadid"),e={columnNum:c.split("-")[1]||b.data("column"),threadNum:c.split("-")[2],postPane:b.length>0?b:$(this).parents(".comment-footer"),timeout:99999},f=this.form?this.form.text.value:$(this).parents(".modal-content").find("form")[0].text.value;if(0!==f.length){this.form?function(){$(this.form.text).attr("disabled","disabled"),$(this).attr("disabled","disabled")}.call(this):$("#reply-textarea, #reply-save").attr("disabled","disabled"),b.length>0?frame_content_height(e.columnNum):void 0;var g=b.length>0?function(a,b,c,d){a.statusCode?topLevelCommentFail(d):a.json&&a.json.errors.length>0?function(){replyLevelCommentFail(d),alert(a.json.errors[0][1])}():postTopLevelComment(a.json.data.things,d)}:function(a,b,c,d){a.statusCode?replyLevelCommentFail(d):a.json&&a.json.errors.length>0?function(){replyLevelCommentFail(d),alert(a.json.errors[0][1])}():insertReplyIntoDOM(a.json.data.things,d)},h=b.length>0?function(a,b,c,d){topLevelCommentFail(d)}:function(a,b,c,d){replyLevelCommentFail(d)},i={thing_id:d,text:f,api_type:"json"},j=a.getRedditAuthHeader();j&&genericPost("https://oauth.reddit.com/api/comment",i,g,h,a.setRedditResponseHeader,e,void 0,j)}}function bindTextAreaReply(){event.preventDefault();var a=this;$.when(checkAccessToken("ruser")).then(function(){return void 0},function(){$(this).parent().parent().hasClass("isTopLevel")||$("#reply-modal").modal("toggle"),$("#login-reddit-modal").modal()}.bind(a))}function bindCancelReply(){event.preventDefault();var a=$(this).parents(".comment-footer");a.length>0?bindReplySwitch.call(a.find(".reply-switch")):showAllColumnOptions($(this).parents(".column-options").data("column"))}function bindReplySwitch(){event.preventDefault(),$("#original-comment").children().remove();var a=$(this).parent().parent().data("id"),b=$(".reddit-html[data-id="+a+"]").clone();author=b.data("author"),$("#reply-modal").modal("toggle"),$("#reply-thing").val(a),$("#original-comment").html(b),$("#reply-title").text(author+" wrote:"),$("#reply-textarea").attr("placeholder","Reply to "+author+"...")}function bindShowReply(){event.preventDefault(),event.stopPropagation();var a=$(this).data("name"),b=$("#"+a+" .media[data-parentid="+a+"]"),c=$(this).find(".expander");b.hasClass("hide")?(c.html("&#8722;"),fadeIn(b.removeClass("hide"),100)):(c.html("&#43;"),b.removeClass("faded").addClass("hide"))}function bindRefreshComment(){event.preventDefault();var a=$(this).data("linkid")||$("#"+$(this).data("parent")).data("linkid"),b=$(this).data("id")||$("#"+$(this).data("parent")).attr("id"),c=$("#"+b).hasClass("parent")||$("#"+$(this).data("parent")).hasClass("parent");getCommentsById(a,b.substr(3).split("-")[0],function(a){var d=b.split("-")[1],e=b.split("-")[2],f=buildCommentHtmlString(appendColNumAndThreadNum(a[1].data.children,d,e));$("#"+b).replaceWith(f),c&&($("#"+b).addClass("parent"),$("#"+b).children(":first").addClass($("#"+b).data("icon"))),$(".reply[data-name="+b+"] .expander").html("&#8722;"),$("#"+b+" .media[data-parentid="+$("#"+b).attr("id")+"]").removeClass("hide").addClass("faded"),$("#"+b).addClass("nopacity"),fadeIn($("#"+b),100),externalLinks(".md a")})}function bindDeleteWatchButtons(){event.preventDefault(),$(this).parent().parent().remove()}function bindWatchAddSubreddit(){event.preventDefault(),$("#watch-subreddits .list-group.contain").append(tmpl("tmpl_al",{}))}function bindWatchAddMatching(){event.preventDefault(),$("#watch-matching .list-group.contain").append(tmpl("tmpl_al",{}))}function bindWatchRefresh(){event.preventDefault(),saveWatchList(),watchList()}function bindWatchSave(){function a(a){return!(""===$(a).val())}event.preventDefault();var b=new Fn,c=$("#watch-subreddits .list-group.contain"),d=$("#watch-matching .list-group.contain");if(0!==c.children().length&&b.any(c.find("input"),a)&&0!==d.children().length&&b.any(d.find("input"),a)){if(saveWatchList(),$(this).hasClass("wthreads")){var e=function(a){return $(a).hasClass("white")};if(b.any("#watch-threads .list-group.contain li",e)){var f=[];$("#watch-threads .list-group.contain li.white").each(function(a,b){var c={},d={};d.subreddit_id=$(b).data("subid"),d.subreddit=$(b).data("subreddit"),d.permalink=$(b).data("thread"),d.id=$(b).data("threadid"),d.title=$(b).text(),c.data=d,f.push(c)}),addToConfigObj(buildRedditConfigObjByThreads(f)),configObjAction(),makeItemActive(b.getFromStorage("config").length-1)}else $("#watch-threads .list-group-item.controls").launchPopOver(3e3,popOverOptions("top","Verification","Please select at least one thread from the list."))}}else{var g="#watch-subreddits .list-group-item.controls, #watch-matching .list-group-item.controls, #watch-threads .list-group-item.controls";$(g).launchPopOver(3e3,popOverOptions("top","Verification","Verify you have one subreddit and one matching pattern added with values."))}}function bindDeleteColumn(){var a=new Fn,b=a.getFromStorage("config"),c=$(this).data("column");b.forEach(function(a,b){deleteRefresh(b)}),a.remove(b,c),a.setInStorage("config",b),delete window["firstComment"+c],buildConfigToUI(!0),$("#delete-column-modal").modal("hide")}function bindAutoRefreshActive(){event.preventDefault(),$("#carousel").unbind("slid.bs.carousel").on("slid.bs.carousel",function(){autoRefreshOnlyActiveColumn()})}function bindColumnButton(){(new Fn).getFromStorage("config").length>0?buildConfigToUI():$(this).parent().launchPopOver(3e3,popOverOptions("top","No columns","Build at least one column to view columns."))}function bindHomeButton(){0===$("#watch-threads .list-group.contain").children().length?watchList():"",showFeature("#greeting")}function bindRedditSearchRadio(){var a=$(this).parents("form").find("select");"submissions"==$(this).parents("form").find("input[type=radio]:checked").val()?a.removeAttr("disabled"):a.attr("disabled",!0)}function bindSaveChanges(){var a=addColumnToConfig();a?function(){buildConfigToUI(!0),makeItemActive((new Fn).getFromStorage("config").length-1)}():buildConfigToUI(),$(".sub-group-controls").remove(),$("#controls").modal("hide")}function bindPreventEnterButton(){if(13==event.which){var a=new Fn;event.preventDefault(),a.getBlurred(),$(this).parent().parent().parent().find("select").focus()}}function bindRedditSearch(a){event.preventDefault();var b=$(this.form).find(".reddit-search-input.tt-input").val(),c=new Fn;if(b){$("#controls").modal("hide");var d=$(this.form).find("input[type=radio]:checked").val(),e=$(this.form).find("select.sorted-by").val(),f=$(this.form).find("select.links-from").val();"subreddits"==d?subredditsSearchAPI({query:b,errorLoc:$(this.form).find(".reddit-search-input.tt-input")}):submissionsSearchAPI({query:b,sorted_by:e,links_from:f,errorLoc:$(this.form).find(".reddit-search-input.tt-input"),callback:a})}c.getBlurred()}function bindRefreshCommentSwitch(a){event.preventDefault();var b=$(this).find("i");b.toggleClass("fa-toggle-on fa-toggle-off"),b.hasClass("fa-toggle-on")&&getCommentsForColumn((new Fn).getFromStorage("config")[a],a),toggleRefresh(a)}function bindGetCommentsForColumn(a){event.preventDefault(),getCommentsForColumn((new Fn).getFromStorage("config")[a],a)}function bindColumnBars(a){event.preventDefault();var b=$(".column-options[data-column="+a+"]");b.hasClass("hide")?(b.removeClass("hide"),column_options_height(a),frame_content_height(),$(".edit-form[data-column="+a+"] .subreddit-group-edit").each(function(a){var b=$(this).find(".subreddit-edit.tt-input").val(),c=$(this).find(".thread-edit"),d=c.val(),e=c.data("column");if(""!==b&&null===d){var f=".edit-form[data-column="+e+"] .thread-edit";getPosts("/r/"+b,"","",{target:[f,a,e],errorMsgLoc:this,callback:setThreads})}})):(showAllColumnOptions(a),b.addClass("hide"),column_options_height(a,0))}function bindManageThreads(a){event.preventDefault();var b=$(".edit-form[data-column="+a+"]");$(this.nextElementSibling).hasClass("hide")?showColumnOption(b,a):showAllColumnOptions(a),frame_content_height(a)}function bindSettings(a){event.preventDefault();var b=$(".settings-tab[data-column="+a+"]");$(this.nextElementSibling).hasClass("hide")?showColumnOption(b,a):showAllColumnOptions(a)}function bindWriteComment(a){event.preventDefault();var b=$(".write-comment[data-column="+a+"]"),c=".write-comment[data-column="+a+"]",d=".edit-form[data-column="+a+"]";setPostThreads(c,d),$(this.nextElementSibling).hasClass("hide")?showColumnOption(b,a):showAllColumnOptions(a),frame_content_height(a)}function bindDeleteColumnButton(a){event.preventDefault(),$("#delete-column").data("column",a),$("#column-to-delete").text((new Fn).getFromStorage("config")[a].settings.name),$("#delete-column-modal").modal()}function bindHelpModal(){$("#help-modal").modal("show")}function bindToggleCommentOptions(){var a=$(this).parents(".media-body:first").find("header:first, footer:first"),b=a.hasClass("hide");$(".media-body header, .media-body footer").addClass("hide"),b&&a.removeClass("hide")}function stopProp(a){a.stopPropagation()}!function(){var a=function(a,b,c,d){for(var g=0;g<a.length;g++)"script"==d?f(a[g],b,c):e(a[g],b,c)},b=function(a,b){for(var c=document.getElementsByTagName("script"==a?"script":"link"),d=0,e=c.length;e>d;d++)if(b==("script"==a?c[d].src:c[d].href)){c[d].parentNode.removeChild(c[d]);break}},c=function(a,b){a.addEventListener("load",function c(d){b&&b(d),a.removeEventListener("load",c,"false")},!1)},d=function(a,b){a.addEventListener("error",function c(d){b&&b(d),a.removeEventListener("error",c,"false")},!1)},e=function(a,b,e){var f=document.createElement("link"),g=document.getElementsByTagName("head")[0];f.type="text/css",f.rel="stylesheet",c(f,b),d(f,e),f.href=a,g.appendChild(f)},f=function(a,b,e){var f=document.createElement("script"),g=document.getElementsByTagName("head")[0];f.type="text/javascript",f.async=!0,c(f,b),d(f,e),f.src=a,g.appendChild(f)},g=function(a){for(var b=document.getElementsByTagName("meta"),c=0,d=b.length;d>c;c++)if(b[c].getAttribute("name")==a)return b[c].getAttribute("content");return""},h=function(){jQuery&&k&&(k=!1,a([n.bootstrapCDN,n.pjaxCDN,n.typeaheadCDN],h,i,"script"));var b="undefined"!=typeof jQuery&&"undefined"!=typeof jQuery.pjax&&"undefined"!=typeof jQuery.fn.emulateTransitionEnd&&"undefined"!=typeof Bloodhound;b&&(!function(){$.fn.launchPopOver=function(a,b){var c=this,d=$(this).data("bs.popover");"undefined"!=typeof d&&d.enabled?(d.options.placement=b.placement,d.options.title=b.title,d.options.content=b.content):$(this).popover(b),d=$(this).data("bs.popover"),"undefined"!=typeof d.timeoutId&&clearTimeout(d.timeoutId),$(this).popover("show"),d.timeoutId=setTimeout(function(){$(c).popover("hide")},a)},$.fn.hasWidthOverflowed=function(){return this.length>0?this[0].scrollWidth>this[0].clientWidth&&this[0].clientWidth>640:!1},document.getElementsByDataAttribute=function(a,b,c){var d=document.querySelectorAll(a),e=[];return d.forEach(function(a){a.getAttribute(b)==c&&e.push(a)}),e},NodeList.prototype.forEach=HTMLCollection.prototype.forEach=function(a){for(var b=0,c=this.length;c>b;b++)a&&a(this[b],b)}}(),init())},i=function(c){try{var d,e=c.srcElement.src;switch(console.warn("Error loading CDN resource: "+e+". Loading local resource."),b("script",e),e){case n.jqueryCDN:d=n.jqueryLocal;break;case n.bootstrapCDN:d=n.bootstrapLocal;break;case n.pjaxCDN:d=n.pjaxLocal;break;case n.typeaheadCDN:d=n.typeaheadLocal}a([d],h,i,"script")}catch(f){throw f}},j=function(a){console.error("Error loading resource: "+a.srcElement.href),b("link",a.srcElement.href)},k=!0,l="true"==g("debug")?!0:!1,m=l?"/src/assets/":"/dist/assets/",n={jqueryCDN:window.location.protocol+"//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js",bootstrapCDN:window.location.protocol+"//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js",pjaxCDN:window.location.protocol+"//cdnjs.cloudflare.com/ajax/libs/jquery.pjax/1.9.6/jquery.pjax.min.js",typeaheadCDN:window.location.protocol+"//cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.11.1/typeahead.bundle.min.js",jqueryLocal:m+"js/jquery-2.1.3.min.js",bootstrapLocal:m+"js/bootstrap.min.js",pjaxLocal:m+"js/jquery.pjax.min.js",typeaheadLocal:m+"js/typeahead.bundle.min.js"},o={app:m+"css/"+(l?"legacy.blenddit.css":"legacy.blenddit.min.css")+"?v="+g("version"),fontawesomeCDN:window.location.protocol+"//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css",googleFont:window.location.protocol+"//fonts.googleapis.com/css?family=Roboto:400,700"};a([n.jqueryCDN],h,i,"script"),a([o.googleFont,o.fontawesomeCDN,o.app],void 0,j,"link")}();var Fn=function(){};Fn.prototype={remove:function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=0>b?a.length+b:b,a.push.apply(a,d)},takeWhile:function(a,b,c){for(var d=[],e=0,f=a.length;f>e&&c(a[e],b);e++)d.push(a[e]);return d},any:function(a,b){var c=!1;return $(a).each(function(a,d){return b(d)?void(c=!0):void 0}),c},deleteCookie:function(a){this.setCookie(a,void 0,!0)},setCookie:function(a,b,c){if(c)return void(document.cookie=a+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;");var d=new Date;d.setTime(d.getTime()+31536e7);var e="expires="+d.toUTCString();document.cookie=a+"="+encodeURIComponent(b)+"; "+e},getCookie:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0===e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return""},cookieExists:function(a){return this.getCookie(a)?!0:!1},getFromStorage:function(a){return"config"==a?localStorage?localStorage.getItem(a)?JSON.parse(localStorage.getItem(a)):[]:this.cookieExists(a)?JSON.parse(this.getCookie(a)):[]:localStorage?localStorage.getItem(a)?JSON.parse(localStorage.getItem(a)):{}:this.cookieExists(a)?JSON.parse(this.getCookie(a)):{}},setInStorage:function(a,b){var b="string"==typeof b?b:JSON.stringify(b);localStorage?(localStorage.setItem(a,b),this.cookieExists(a)?this.deleteCookie(a):void 0):this.setCookie(a,b)},brokenImage:function(a){$(a).parents(".media a").empty().append(tmpl("tmpl_ap",{}))},getBlurred:function(){document.activeElement.blur(),$("input").blur()},setUserSession:function(a,b){var c=0===Object.keys(JSON.parse(decodeURIComponent(atob(b)))).length;c||this.setInStorage(a,b)},getUserSession:function(a){return localStorage.getItem(a)?JSON.parse(decodeURIComponent(atob(localStorage.getItem(a)))):void 0},getRedditAuthHeader:function(){var a=void 0,b=this.getUserSession("ruser"),c=b.x_ratelimit_remaining?parseInt(b.x_ratelimit_remaining)>0||parseInt(b.x_ratelimit_reset)<=0?!0:!1:!0;return b&&c&&(a={Authorization:"bearer "+b.at}),b&&!c&&alert("Please wait "+b.x_ratelimit_reset+" seconds."),a},setRedditResponseHeader:function(a,b,c){200==c.status&&"function"==typeof c.getResponseHeader&&(new Fn).setUserSessionAttributes("ruser",{x_ratelimit_remaining:c.getResponseHeader("x-ratelimit-remaining"),x_ratelimit_reset:c.getResponseHeader("x-ratelimit-reset")})},setUserSessionAttributes:function(a,b){var c=this.getUserSession(a);Object.keys(b).forEach(function(a){c[a]=b[a]}),this.setUserSession(a,btoa(encodeURIComponent(JSON.stringify(c))))}},function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-57745225-1","auto"),ga("send","pageview");